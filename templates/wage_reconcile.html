<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>å¦¹å¦¹è–ªæ°´å°å¸³å·¥å…·</title>
  <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Zen Maru Gothic','å¾®è»Ÿæ­£é»‘é«”',sans-serif;background:#f7f9fb;margin:0;color:#333}
    .header{padding:16px 20px;text-align:center;background:#e3f2fd;box-shadow:0 2px 8px rgba(0,0,0,.06)}
    .header h2{margin:0;font-size:1.4rem}
    .header-links{margin-top:8px}
    .header-links a{display:inline-block;margin:4px 6px;background:#2196f3;color:#fff;padding:6px 10px;border-radius:999px;text-decoration:none;font-size:.8rem}
    .container{max-width:1100px;margin:20px auto 32px;padding:0 18px}
    .card{background:#fff;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,.06);padding:18px 18px 20px;margin-bottom:18px}
    .card h3{margin:0 0 10px;font-size:1.1rem}
    .form-grid{display:grid;grid-template-columns:1.1fr 1.6fr;gap:16px}
    @media(max-width:840px){.form-grid{grid-template-columns:1fr}}
    textarea{width:100%;min-height:80px;font-family:inherit;font-size:.85rem;padding:8px 10px;border-radius:8px;border:1px solid #cfd8dc;resize:vertical}
    label{font-size:.85rem;font-weight:600;color:#455a64;display:block;margin-bottom:4px}
    .hint{font-size:.75rem;color:#78909c;margin-top:4px;line-height:1.5}
    .actions{margin-top:10px;display:flex;align-items:center;gap:14px;flex-wrap:wrap}
    .btn{background:#1976d2;border:none;color:#fff;border-radius:8px;padding:8px 16px;font-size:.9rem;cursor:pointer}
    .checkbox{font-size:.85rem;color:#455a64;display:flex;align-items:center;gap:6px}
    .summary-row{display:flex;flex-wrap:wrap;gap:10px;margin-top:6px}
    .pill{background:#e3f2fd;color:#0d47a1;border-radius:999px;padding:6px 12px;font-size:.85rem}
    .pill strong{font-weight:700}
    .errors{margin:6px 0 0;padding:8px 10px;border-radius:8px;background:#ffebee;color:#c62828;font-size:.8rem}
    table{width:100%;border-collapse:collapse;font-size:.82rem;margin-top:8px}
    th,td{border-bottom:1px solid #e0e0e0;padding:6px 8px;text-align:left}
    thead tr{background:#eceff1}
    tr:nth-child(even){background:#fafafa}
    tr:hover{background:#f1f5f9}
    .note{font-size:.75rem;color:#ef6c00}
  </style>
</head>
<body>
  <div class="header">
    <h2>ğŸ“’ å¦¹å¦¹è–ªæ°´å°å¸³å·¥å…·</h2>
    <div class="header-links">
      <a href="/admin/home">å›å¾Œå°ä¸»é </a>
      <a href="/admin/wallet">å„²å€¼é‡‘å°ˆå€</a>
      <a href="/admin/wallet/reconcile">å„²å€¼å°å¸³</a>
    </div>
  </div>

  <div class="container">
    <div class="card">
      <h3>è¼¸å…¥è³‡æ–™</h3>
      <form method="post">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
        <div class="form-grid">
          <div>
            <label>å¦¹å¦¹è–ªè³‡è¨­å®š</label>
            <textarea name="salary_config" rows="4" placeholder="ä¾‹å¦‚ï¼š&#10;å®‰å¸Œ 1100=40 1400=60 2400=90&#10;å°ç¾ 1100=40 1400=60 2400=90">{{ salary_config_text }}</textarea>
            <div class="hint">
              ä¸€è¡Œä¸€ä½å¦¹å¦¹ï¼š<br>
              ã€Œå§“å ç©ºæ ¼ é‡‘é¡=åˆ†é˜ é‡‘é¡=åˆ†é˜ ...ã€<br>
              ä¾‹å¦‚ï¼šå®‰å¸Œ 1100=40 1400=60 2400=90 ä»£è¡¨ï¼š40 åˆ†çµ¦ 1100ï¼Œ60 åˆ†çµ¦ 1400ï¼Œ90 åˆ†çµ¦ 2400ã€‚
            </div>
          </div>
          <div>
            <label>ç•¶æ—¥ç´€éŒ„è²¼ä¸Š</label>
            <textarea name="records" rows="10" placeholder="ä¾‹å¦‚ï¼š&#10;12/13&#10;12:00æ³°2700/60/1&#10;15:30å¹¸3200/60/1&#10;18:00æ³°3500/90/2&#10;19:30æ³°2700/60/1&#10;21:30æ³°2700/60/1">{{ records_text }}</textarea>
            <div class="hint">
              æ”¯æ´ä½ å¹³å¸¸è²¼ä¸Šçš„æ ¼å¼ï¼š<br>
              æ—¥æœŸè¡Œï¼ˆå¦‚ï¼š12/13ï¼‰æœƒè‡ªå‹•å¿½ç•¥ã€‚<br>
              æ¯ç­†æ ¼å¼ï¼šæ™‚é–“+å§“å+é‡‘é¡/åˆ†é˜æ•¸/äººæ•¸ï¼Œä¾‹å¦‚ï¼š12:00æ³°2700/60/1ã€‚<br>
              ç³»çµ±æœƒä¾ã€Œå§“å + åˆ†é˜æ•¸ã€å»æ‰¾ä¸Šæ–¹è¨­å®šçš„è–ªæ°´ï¼Œä¸€è¡Œç®—ä¸€ä»½è–ªæ°´ã€‚
            </div>
          </div>
        </div>
        <div class="actions">
          <label class="checkbox">
            <input type="checkbox" name="include_meal" value="1" {% if include_meal %}checked{% endif %} />
            é£¯éŒ¢ 200 å…ƒï¼ˆæœ‰é£¯éŒ¢å°±å‹¾é¸ï¼‰
          </label>
          <button type="submit" class="btn">è¨ˆç®—</button>
        </div>
      </form>
    </div>

    {% if errors %}
    <div class="card">
      <h3>æ³¨æ„äº‹é …</h3>
      <div class="errors">
        {% for e in errors %}
          <div>ãƒ»{{ e }}</div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    {% if result %}
    <div class="card">
      <h3>å°å¸³çµæœ</h3>
      <div class="summary-row">
        <div class="pill">ä»Šæ—¥ç¸½æ”¶ï¼š<strong>{{ result.total_revenue }}</strong></div>
        <div class="pill">å¦¹å¦¹è–ªæ°´åˆè¨ˆï¼š<strong>{{ result.total_salary }}</strong></div>
        <div class="pill">é£¯éŒ¢ï¼š<strong>{{ result.meal_fee }}</strong></div>
        <div class="pill">ç¸½æ”¶ï¼ˆä»Šæ—¥ç¸½æ”¶ âˆ’ å¦¹å¦¹è–ªæ°´ âˆ’ é£¯éŒ¢ï¼‰ï¼š<strong>{{ result.net }}</strong></div>
      </div>
    </div>

    <div class="card">
      <h3>æ˜ç´°æª¢æŸ¥</h3>
      <table>
        <thead>
          <tr>
            <th>åŸå§‹æ–‡å­—</th>
            <th>æ™‚é–“</th>
            <th>å¦¹å¦¹</th>
            <th>é‡‘é¡</th>
            <th>åˆ†é˜æ•¸</th>
            <th>äººæ•¸</th>
            <th>è¨ˆå…¥ç¸½æ”¶</th>
            <th>æ­¤ç­†è–ªæ°´</th>
            <th>å‚™è¨»</th>
          </tr>
        </thead>
        <tbody>
          {% for r in entries %}
          <tr>
            <td>{{ r.raw }}</td>
            <td>{{ r.time }}</td>
            <td>{{ r.name }}</td>
            <td>{{ r.amount }}</td>
            <td>{{ r.length }}</td>
            <td>{{ r.count }}</td>
            <td>{{ r.revenue }}</td>
            <td>{{ r.salary }}</td>
            <td class="note">{{ r.note }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}
  </div>
</body>
</html>
