{% extends 'royal_base.html' %}
{% block body %}
<div class="royal-card" style="max-width:900px;margin:2em auto 0 auto;padding:2.5em 2em 2em 2em;background:rgba(44,34,68,0.97);border-radius:18px;box-shadow:0 4px 24px #1a2337;">
    <div style="text-align:right;margin-bottom:1em;">
        <a href="/" class="royal-btn royal-effect">回到主頁</a>
    </div>
    <h2 class="royal-title mb-4" style="text-align:center;">白名單列表</h2>
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div style="max-width:600px;margin:1em auto;">
          {% for category, message in messages %}
            <div class="royal-card" style="background:#3a2c5e;">{{ message }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    {% if whitelists %}
    <div style="overflow-x:auto;">
      <table class="royal-table" style="width:100%;margin-top:1.5em;">
        <thead>
          <tr>
            <th>暱稱</th>
            <th>手機</th>
            <th>LINE ID</th>
            <th>LINE用戶ID</th>
            <th>加入日期</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody>
        {% for w in whitelists %}
          <tr>
            <td>{{ w.name }}</td>
            <td>{{ w.phone }}</td>
            <td>{{ w.line_id }}</td>
            <td>{{ w.line_user_id }}</td>
            <td>{{ w.date or w.created_at.strftime('%Y-%m-%d') }}</td>
            <td>
              <form method="post" action="/admin/whitelist/delete/" style="display:inline;">
                <input type="hidden" name="id" value="{{ w.id }}">
                <button type="submit" class="royal-btn" style="background:#a94442;">移除</button>
              </form>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="royal-card" style="background:#2e1e4d;text-align:center;">目前沒有白名單資料。</div>
    {% endif %}
</div>
{% endblock %}
