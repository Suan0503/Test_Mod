<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>管理介面</title>
  <link rel="stylesheet" href="/static/admin_custom.css">
  <style>
    .user-table { border-collapse: collapse; width:100%; margin-top:32px; }
    .user-table th, .user-table td { border:1px solid #b6d6ff; padding:8px; text-align:center; }
    .user-table th { background:#e3f2fd; }
    .renew-form { display:flex;gap:8px;justify-content:center; }
    .renew-btn { background:#4caf50;color:#fff;padding:4px 12px;border-radius:6px;border:none;font-weight:600; }
  </style>
</head>
<body>
  <h2>會員續費與用戶組管理（超級管理員專用）</h2>
  <div style="color:#1976d2;font-size:15px;margin-bottom:12px;">可直接修改用戶組（user_group）與續費天數</div>
  <table class="user-table">
    <thead>
      <tr><th>ID</th><th>帳號</th><th>用戶組</th><th>到期日</th><th>續費</th><th>變更用戶組</th></tr>
    </thead>
    <tbody>
      {% for user in users %}
      <tr>
        <td>{{ user.id }}</td>
        <td>{{ user.username }}</td>
        <td>{{ user.user_group }}</td>
        <td>{% if user.expire_date %}{{ user.expire_date.strftime('%Y-%m-%d') }}{% else %}未設定{% endif %}</td>
        <td>
          <form class="renew-form" method="POST">
            <input type="hidden" name="user_id" value="{{ user.id }}">
            <input type="number" name="days" min="1" max="365" placeholder="天數" required>
            <button class="renew-btn" type="submit">續費</button>
          </form>
        </td>
        <td>
          <form method="POST" action="/admin/user/group" style="display:inline;">
            <input type="hidden" name="user_id" value="{{ user.id }}">
            <select name="user_group" onchange="this.form.submit()">
              <option value="superadmin" {% if user.user_group=='superadmin' %}selected{% endif %}>超級管理員</option>
              <option value="admin" {% if user.user_group=='admin' %}selected{% endif %}>管理員</option>
              <option value="switchboard" {% if user.user_group=='switchboard' %}selected{% endif %}>總機</option>
              <option value="operator" {% if user.user_group=='operator' %}selected{% endif %}>操作人員</option>
            </select>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <a href="/">回主頁</a>
</body>
</html>
